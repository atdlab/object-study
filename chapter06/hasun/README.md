# chapter6. 메시지와 인터페이스

### 훌륭한 객체지향 코드

- 협력 안에서 객체가 수행하는 책임에 초점
- 객체지향 애플리케이션의 가장 중요한 재료 = 객체들이 주고받는 메시지
- 애플리케이션은 클래스로 구성되지만 메시지를 통해 정의된다
- 유연하고 재사용 가능한 퍼블릭 인터페이스를 만드는 데 도움이 되는 설계 원칙과 기법 익히기

## 01. 협력과 메시지

### 메시지

- 메시지는 객체들이 협력하기 위해 사용할 수 있는 유일한 의사소통 수단

### 오퍼레이션

- 프로그래밍 언어의 관점에서 퍼블릭 인터페이스에 포함된 메시지
- 오퍼레이션은 수행 가능한 어떤 행동에 대한 추상화
- 내부의 구현 코드는 제외하고 단순히 메시지와 관련된 시그니처를 가리키는 경우가 대부분이다

### 메서드

- 메시지를 수신했을 때 실제로 실행되는 함수 또는 프로시저
- 코드 상에서 동일한 이름의 변수에게 동일한 메시지를 전송하더라도 객체의 타입에 따라 실행되는 메서드가 달라질 수 있다

### 퍼블릭 인터페이스

- 객체가 의사소통을 위해 외부에 공개하는 메시지의 집합

### 시그니처

- 오퍼레이션이나 메서드의 명세를 나타낸 것
- 이름과 인자의 목록을 포함한다

## 02. 인터페이스와 설계 품질

- 좋은 인터페이스는 최소한의 인터페이스와 추상적인 인터페이스라는 조건을 만족해야 함
- 최소한의 인터페이스는 꼭 필요한 오퍼레이션만을 인터페이스에 포함
- 추상적인 인터페이스는 어떻게 수행하는지가 아니라 무엇을 하는지를 표현

### 디미터 법칙

- 객체의 내부 구조에 강하게 결합되지 않도록 협력 경로를 제한하라는 것
- 낯선 자에게 말하지 말라
- 오직 인접한 이웃하고만 말하라
- 클래스가 특정한 조건을 만족하는 대상에게만 메시지를 전송하도록 프로그래밍 해야 함
- 객체의 내부 구조를 묻는 메시지가 아니라 수신자에게 무언가를 시키는 메시지

### 묻지 말고 시켜라

- 메시지 전송자는 메시지 수신자의 상태를 기반으로 결정을 내린 후 수신자의 상태를 바꿔서는 안됨
- 내부의 상태를 이용해 어떤 결정을 내리는 로직이 객체 외부에 존재하지 않도록
- 매 순간 묻지 말고 시켜라
- 호출되는 객체가 어떻게 해야 하는지를 스스로 결정하게 해야 한다
- 인터페이스는 객체가 어떻게 하는지가 아니라 무엇을 하는지를 서술

### 의도를 드러내는 인터페이스

- 메서드의 이름 짓기
    - 메서드가 작업을 ‘어떻게’ 수행하는지를 나타내도록
        - 메서드의 이름은 내부의 구현 방법을 드러냄
        - 동일한 작업을 수행한다는 사실을 알아채기 어려움
        - 협력하는 객체의 종류를 알도록 강요함
    - ‘어떻게’가 아니라 ‘무엇’을 하는지를 드러내기
        - 코드를 읽고 이해하기 쉽게 만들고 유연한 코드를 낳는 지름길이다
        - 어떻게 수행하는지를 드러내는 이름이란 메서드의 내부 구현을 설명하는 이름
- 구현과 관련된 모든 정보를 캡슐화하고 객체의 퍼블릿 인터페이스에는 협력과 관련된 의도만을 표현해야 함
- 객체 자신이 아닌 클라이언트의 의도를 표현하는 이름

### 명령-쿼리 분리

- 명령과 쿼리를 분리하는 것
- 아래에서 자세히 설명

## 03. 원칙의 함정

### 디미터 법칙은 하나의 도트(.)를 강제하는 규칙이 아니다

### 결합도와 응집도의 충돌

- 디미터 법칙의 위반 여부는 묻는 대상이 객체인지, 자료 구조이지에 달려 있다
- 객체는 내부 구조를 숨겨야 하므로 디미터 법칙을 따르는 것이 좋지만 자료 구조라면 당연히 내부를 노출해야 하므로 디미터 법칙을 적용할 필요가 없다

## 04. 명령-쿼리 분리 원칙

- 어떤 오퍼레이션도 명령인 동시에 쿼리여서는 안 된다
- 객체는 블랙박스이며 객체의 인터페이스는 객체의 관찰 가능한 상태를 보기 위한 일련의 디스플레이와 객체의 상태를 변경하기 위해 누를 수 있는 버튼의 집합

### 반복 일정의 명령과 쿼리 분리하기

- 명령과 쿼리를 뒤섞으면 실행 결과를 예측하기가 어려워질 수 있다

### 명령-쿼리 분리와 참조 투명성

- 참조 투명성
    - “어떤 표현식 e가 있을 때 e의 값으로 e가 나타나는 모든 위치를 교체하더라도 결과가 달라지지 않는 특성”
- 참조 투명성의 장점
    - 모든 함수를 이미 알고 있는 하나의 결과값으로 대체할 수 있기 때문에 식을 쉽게 계산할 수 있다
    - 모든 곳에서 함수의 결괏값이 동일 → 순서를 변경해도 결과는 달라지지 않는다

### 책임에 초점을 맞춰라

- 메세지를 먼저 선택하고 그 후에 메시지를 처리할 객체를 선택해라
- 객체의 구현 이전에 객체 사이의 협력에 초점을 맞추고 협력 방식을 단순하고 유연하게 만드는 것
- 메시지가 객체를 선택하게
- 실제로 실행 시점에 필요한 구체적인 제약이나 조건을 명확하게 표현하지는 못함