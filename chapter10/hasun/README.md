# chapter10. 상속과 코드 재사용

코드의 재사용

- 객체지향 프로그래밍의 장점
- 객체지향에서는 재사용을 위해 ‘새로운’코드를 추가한다

## 01. 상속과 중복 코드

### DRY 원칙

- Don’t Repeat Yourself
- 반복하지 마라
- 모든 지식은 시스템 내에서 단일하고, 애매하지 않고, 정말로 믿을 만한 표현 양식을 가져야 한다

### 상속을 이용해서 중복 코드 제거하기

- 개발자의 가정을 이해하기 전에는 코드를 이해하기 어렵다
- 실제 프로젝트에서 마주치게 될 클래스의 상속 계층은 매우 깊을 것
- 상속을 이용해 코드를 재사용하기 위해서는 부모 클래스의 개발자가 세웠던 가정이나 추론 과정을 정확하게 이해해야 한다
- 따라서 상속은 결합도를 높인다

### 상속을 위한 경고 1

- 자식 클래스의 메서드 안에서 super 참조를 이용해 부모 클래스의 메서드를 직접 호출할 경우 결합도 상승
- super 호출을 제거하여 결합도를 제거하라

## 02. 취약한 기반 클래스 문제

- 부모 클래스의 작은 변경에도 자식 클래스는 컴파일 오류와 실행 에러라는 고통에 시달려야 할 수도 있다

### 상속을 위한 경고 2

- 상속받은 부모 클래스의 메서드가 자식 클래스의 내부 구조에 대한 규칙을 깨트릴 수 있다

### 메서드 오버라이딩의 오작용 문제

- InstrumentedHashSet 클래스 예제

```java
InstrumentedHashSet<String> languages = new InstrumentedHashSet<>(); 
languages.addAll(Arrays.asList("Java", "Ruby", "Scala"));
```

- HashSet의 addAll 메서드 안에서 add 메서드 호출 → InstrumentedHashSet의 add 메서드 호출

### 상속을 위한 경고 3

- 자식 클래스가 부모 클래스의 메서드를 오버라이딩할 경우 부모 클래스가 자신의 메서드를 사용하는 방법에 자식 클래스가 결합될 수 있다

> 클래스가 상속되기를 원한다면 상속을 위해 클래스를 설계하고 문서화해야 하며, 그렇지 않은 경우에는 상속을 금지시켜야 한다 -조슈아 블로치
>

### 상속을 위한 경고 4

- 클래스를 상속하면 결합도로 인해 자식 클래스와 부모 클래스의 구현을 영원히 변경하지 않거나 자식 클래스와 부모 클래스를 동시에 변경하거나 둘 중 하나를 선택할 수밖에 없다

## 03. Phone 다시 살펴보기

### 추상화에 의존하자

- 두 메서드가 유사하게 보인다면 차이점을 메서드로 추출
- 부모 클래스의 코드를 하위로 내리지 말고 자식 클래스의 코드를 상위로 올려라
    - 부모 클래스에서 자식 클래스가 오버라이딩한 코드 사용

### 세금 추가하기

- 부모 클래스인 Phone에 인스턴스 변수를 추가했더니 자식 클래스 생성자 모두에 해당 인스턴스 변수를 추가해줘야한다
- 인스턴스 변수의 추가는 종종 상속 계층 전반에 걸친 변경을 유발한다
- 메서드 구현에 대한 결합은 추상 메서드를 추가함으로써 어느 정도 완화할 수 있지만 인스턴스 변수에 대한 잠재적인 결합을 제거할 수 있는 방법은 없다

## 04. 차이에 의한 프로그래밍

- 기존 코드와 다른 부분만을 추가함으로써 애플리케이션의 기능을 확장하는 방법
- 정말로 필요한 경우에만 상속을 사용하라